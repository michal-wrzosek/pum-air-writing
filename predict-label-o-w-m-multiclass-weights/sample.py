import os
from pprint import pprint
from dataikuscoring import load_model


path_to_export = os.path.dirname(os.path.realpath(__file__))

# Load the model from current export path
model = load_model(path_to_export)

# The model provides a simple api similar to scikit-learn with:
# * model.predict to get scoring for a given input data
# * model.predict_proba to get probabilities in case of classification
#
# The accepted format for input data can be either:
# * pandas.DataFrame
# * List of dictionnaries
# * 2D numpy array
# * List of List
#
# The first dimension corresponds to observations
data_to_score = [
    {
        "duration_ms": 1701
        ,"total_path_length": 40.76250612296151
        ,"avg_step_length": 2.1453950591032376
        ,"range_x": 2.515789473684208
        ,"range_y": 5.152631578947368
        ,"range_z": 7.536842105263158
        ,"p1_x": 0.0
        ,"p1_y": 0.0
        ,"p1_z": 0.0
        ,"p1_t": 34.0
        ,"p2_x": -0.5210526315789474
        ,"p2_y": 0.2894736842105263
        ,"p2_z": 0.06842105263157883
        ,"p2_t": 116.0
        ,"p3_x": -0.35789473684210515
        ,"p3_y": 0.8578947368421052
        ,"p3_z": 0.23684210526315774
        ,"p3_t": 297.0
        ,"p4_x": -0.3736842105263158
        ,"p4_y": 1.6263157894736842
        ,"p4_z": 1.810526315789474
        ,"p4_t": 424.0
        ,"p5_x": 0.7263157894736847
        ,"p5_y": 1.0105263157894744
        ,"p5_z": 0.836842105263159
        ,"p5_t": 511.0
        ,"p6_x": 0.49473684210526303
        ,"p6_y": -0.9421052631578947
        ,"p6_z": -0.38421052631578906
        ,"p6_t": 593.0
        ,"p7_x": 0.026315789473684237
        ,"p7_y": -2.273684210526316
        ,"p7_z": -2.1842105263157894
        ,"p7_t": 674.0
        ,"p8_x": -1.4578947368421056
        ,"p8_y": -2.673684210526316
        ,"p8_z": -3.8684210526315788
        ,"p8_t": 755.0
        ,"p9_x": -1.2684210526315796
        ,"p9_y": -0.4736842105263178
        ,"p9_z": -1.8947368421052668
        ,"p9_t": 837.0
        ,"p10_x": -1.615789473684211
        ,"p10_y": 2.0157894736842112
        ,"p10_z": 1.9263157894736853
        ,"p10_t": 919.0
        ,"p11_x": -1.3
        ,"p11_y": 2.4157894736842107
        ,"p11_z": 3.415789473684211
        ,"p11_t": 1000.0
        ,"p12_x": 0.021052631578948655
        ,"p12_y": 0.8631578947368411
        ,"p12_z": 1.273684210526313
        ,"p12_t": 1082.0
        ,"p13_x": 0.7
        ,"p13_y": -0.27368421052631586
        ,"p13_z": -1.1473684210526316
        ,"p13_t": 1164.0
        ,"p14_x": 0.5631578947368417
        ,"p14_y": -1.163157894736842
        ,"p14_z": -1.8631578947368417
        ,"p14_t": 1245.0
        ,"p15_x": -0.21578947368421103
        ,"p15_y": -1.8105263157894744
        ,"p15_z": -2.3473684210526318
        ,"p15_t": 1326.0
        ,"p16_x": -1.4157894736842112
        ,"p16_y": -2.231578947368422
        ,"p16_z": -2.3000000000000003
        ,"p16_t": 1408.0
        ,"p17_x": -1.7894736842105232
        ,"p17_y": -0.6
        ,"p17_z": -1.1736842105263179
        ,"p17_t": 1490.0
        ,"p18_x": -1.463157894736844
        ,"p18_y": 2.242105263157896
        ,"p18_z": 1.9210526315789482
        ,"p18_t": 1571.0
        ,"p19_x": -1.557894736842104
        ,"p19_y": 2.478947368421052
        ,"p19_z": 3.668421052631579
        ,"p19_t": 1653.0
        ,"p20_x": -0.6000000000000001
        ,"p20_y": 1.0
        ,"p20_z": 1.3000000000000003
        ,"p20_t": 1735.0
    }
    ,{
        "duration_ms": 1317
        ,"total_path_length": 36.055428931042755
        ,"avg_step_length": 1.8976541542654082
        ,"range_x": 2.7
        ,"range_y": 5.300000000000001
        ,"range_z": 6.0
        ,"p1_x": 0.0
        ,"p1_y": 0.0
        ,"p1_z": 0.0
        ,"p1_t": 67.0
        ,"p2_x": 0.5
        ,"p2_y": 0.7
        ,"p2_z": 1.1000000000000003
        ,"p2_t": 134.0
        ,"p3_x": 0.30000000000000004
        ,"p3_y": -0.20000000000000007
        ,"p3_z": 0.10000000000000009
        ,"p3_t": 200.0
        ,"p4_x": 0.7
        ,"p4_y": -1.0
        ,"p4_z": -1.9000000000000001
        ,"p4_t": 267.0
        ,"p5_x": 0.0
        ,"p5_y": -2.1
        ,"p5_z": -2.9000000000000004
        ,"p5_t": 350.0
        ,"p6_x": -0.2
        ,"p6_y": -2.9000000000000004
        ,"p6_z": -4.2
        ,"p6_t": 417.0
        ,"p7_x": -1.0000000000000002
        ,"p7_y": -2.4000000000000004
        ,"p7_z": -4.3
        ,"p7_t": 485.0
        ,"p8_x": -1.3
        ,"p8_y": -1.0
        ,"p8_z": -2.6
        ,"p8_t": 551.0
        ,"p9_x": -1.5000000000000002
        ,"p9_y": 1.4
        ,"p9_z": -0.6
        ,"p9_t": 618.0
        ,"p10_x": -0.10000000000000003
        ,"p10_y": 2.1
        ,"p10_z": 1.7
        ,"p10_t": 684.0
        ,"p11_x": -1.1
        ,"p11_y": -0.30000000000000004
        ,"p11_z": 0.6000000000000001
        ,"p11_t": 751.0
        ,"p12_x": 0.4
        ,"p12_y": -0.7000000000000001
        ,"p12_z": -2.0
        ,"p12_t": 817.0
        ,"p13_x": -0.10000000000000003
        ,"p13_y": -1.9000000000000001
        ,"p13_z": -2.6
        ,"p13_t": 900.0
        ,"p14_x": -0.7
        ,"p14_y": -2.5
        ,"p14_z": -3.1
        ,"p14_t": 967.0
        ,"p15_x": -1.4000000000000001
        ,"p15_y": -3.2
        ,"p15_z": -3.3
        ,"p15_t": 1034.0
        ,"p16_x": -2.0
        ,"p16_y": -2.6
        ,"p16_z": -4.0
        ,"p16_t": 1100.0
        ,"p17_x": -0.7
        ,"p17_y": 0.30000000000000004
        ,"p17_z": -0.7
        ,"p17_t": 1184.0
        ,"p18_x": -1.6
        ,"p18_y": 1.0
        ,"p18_z": 0.5
        ,"p18_t": 1251.0
        ,"p19_x": -1.7000000000000002
        ,"p19_y": 0.6000000000000001
        ,"p19_z": 0.9000000000000001
        ,"p19_t": 1317.0
        ,"p20_x": -1.5000000000000002
        ,"p20_y": -0.4
        ,"p20_z": -0.4
        ,"p20_t": 1384.0
    }
]


# For instance the following will output a numpy array containing the predictions for each
# observation

predict_result = model.predict(data_to_score)
print(" \nOutput of model.predict():\n")
pprint(predict_result)

# In case of classification the following will output a dictionnary of numpy array with
# probabilities for each class
predict_proba_result = model.predict_proba(data_to_score)
print(" \nOutput of model.predict_proba():\n")
pprint(predict_proba_result)
